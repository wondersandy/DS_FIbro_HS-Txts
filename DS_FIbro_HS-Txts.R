library(BiocManager)
install()
library(limma)
library(edgeR)
library(Glimma)
library(XLConnect)
options(java.parameters = "-Xmx8000m")
library(RColorBrewer)
library(gplots)

metaData <- loadWorkbook("~/Bioinformatics/DS Fibro_Hs_p38.FYN.BACE/NYU-GTC_ShippedSampleInfo-1-29-20.xlsx")
metaData <- readWorksheet(metaData, sheet = 1, startRow = 10, startCol = 2, header = T)

head(metaData)
tail(metaData)
str(metaData$Sample.Number)

samplenames <- as.character(c(paste0("DS", "-", 1:20), paste0("2N", "-", 1:20)))
samplenames # 40

metaData <- metaData[metaData$Sample.Number %in% samplenames, ]

dim(metaData) # 40 10
head(metaData)
tail(metaData)

cts <- read.delim("~/Bioinformatics/DS Fibro_Hs_p38.FYN.BACE/Analysis/Sai PreProcessing/New_Data_022020/Merged_unstr_counts.txt", sep = "\t", 
                  header = T, stringsAsFactors = F)
head(cts)
dim(cts) # 59050    41

length(unique(cts$X.GENE)) # 59050

cts <- data.frame(cts[,-1], row.names = cts$X.GENE, stringsAsFactors = F)
head(cts)
tail(cts)
dim(cts) # 59050    40

library(tools)
file_path_sans_ext(colnames(cts)) # Ref: https://stackoverflow.com/a/44547135/5995531 

colnames(cts) <- file_path_sans_ext(colnames(cts)) # Basically removing extension. See above reference.
head(cts)
colnames(cts)
class(colnames(cts)) # "character"
mode(colnames(cts)) # "character"

colnames(cts) <- ifelse(colnames(cts) %in% grep("X2N", colnames(cts), value = T), gsub("X2N", "WT", colnames(cts)), colnames(cts))
head(cts)

cts <- cts[, c(21:40,1:20)]
head(cts)








































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































